<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ResourceViewModels="clr-namespace:InitManage.ViewModels.Resource"
             xmlns:DataTemplates="clr-namespace:InitManage.Views.DataTemplates"
             xmlns:Wrappers="clr-namespace:InitManage.Models.Wrappers"
             x:Class="InitManage.Views.Pages.CreateResourcePage"
             NavigationPage.HasNavigationBar="False"
             x:DataType="ResourceViewModels:CreateResourceViewModel"
             IconImageSource="admin"
             BackgroundColor="{AppThemeBinding Light={StaticResource Light}, Dark={StaticResource Dark}}"
             Title="Administration">

    <Grid RowDefinitions="200, *">
        <Image
            Aspect="Fill"
            Source="{Binding Picture, Mode=OneWay}"/>
        <!-- Formulaire de création de ressource -->
        <StackLayout Margin="10" Spacing="10" Grid.Row="1">
            <!-- Nom de la ressource -->
            <Entry 
                Text="{Binding Name}"
                Placeholder="Nom"/>
            <!-- description de la ressource -->
            <Editor
                Text="{Binding Description}"
                Placeholder="Description"
                HeightRequest="100"
                IsTextPredictionEnabled="true"/>
            <!-- Lien de la photo -->
            <Entry 
                Text="{Binding Picture}"
                Placeholder="Lien de la photo"
                IsTextPredictionEnabled="False"
                />

            <Picker
                HorizontalOptions="FillAndExpand"
                Title="Types"
                SelectedItem="{Binding Type}"
                ItemsSource="{Binding Types}"/>
            <!-- Nombre de place -->
            <StackLayout Spacing="10" Orientation="Horizontal">
                <Label
                    VerticalOptions="Center"
                    Text="Nombre de places :"/>
                
                <Entry
                    Keyboard="Numeric"
                    Text="{Binding Capacity}"
                    Placeholder="Nombre de place"/>
            </StackLayout>
            
            <CollectionView ItemsSource="{Binding Options}" HeightRequest="100" x:Name="optionsList">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" Span="2" VerticalItemSpacing="5" HorizontalItemSpacing="5"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="Wrappers:OptionWrapper">
                        <StackLayout HorizontalOptions="FillAndExpand">
                            <Frame
                                HasShadow="False"
                                Padding="10"
                                BackgroundColor="{Binding IsSelected, Converter={StaticResource BoolToPrimaryColorValueConverter}}">
                                <StackLayout Orientation="Horizontal">
                                    <Label
                                        TextColor="{Binding IsSelected, Converter={StaticResource BoolToBlackColorValueConverter}}"
                                        HorizontalOptions="Center"
                                        Text="{Binding Name}"
                                        HorizontalTextAlignment="Center"/>
                                </StackLayout>
                                <Frame.GestureRecognizers>
                                    <TapGestureRecognizer
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type ResourceViewModels:CreateResourceViewModel}}, Path=OptionTappedCommand}" CommandParameter="{Binding .}"/>
                                </Frame.GestureRecognizers>
                            </Frame>
                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

            </CollectionView>


            <!-- bouton de confirmation -->
            <Button
                Command="{Binding CreateCommand}"
                Text="Créer">
                <Button.Shadow>
                    <Shadow
                        Opacity="0.5"
                        Radius="5"
                        Offset="5, 5"/>
                </Button.Shadow>
            </Button>

        </StackLayout>
    </Grid>
</ContentPage>